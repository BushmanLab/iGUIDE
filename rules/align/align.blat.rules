# -*- mode: Snakemake -*-
# Sequence Alignment: BLAT

rule align:
  input:
    RUN_DIR + "/process/consolidated/{sample}.{read}.consol.fasta"
  output:
    RUN_DIR + "/process/aligned/{sample}.{read}.psl"
  params:
    GENOME=config["RefGenome"],
    BLATparams=config["BLATparams"]
  shell:
    "blat {params.GENOME} {input} {output} {params.BLATparams}"

rule compress_align:
  input:
    RUN_DIR + "/process/aligned/{sample}.{type}.psl"
  output:
    RUN_DIR + "/process/aligned/{sample}.{type}.psl.gz"
  shell:
    "gzip {input}"

