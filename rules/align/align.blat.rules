# -*- mode: Snakemake -*-
# Sequence Alignment: BLAT

rule align:
  input:
    "{sample}.{read}.consol.fasta"
  output:
    "{sample}.{read}.psl"
  params:
    GENOME=config["RefGenome"],
    BLATparams=config["BLATparams"]
  shell:
    """
    blat {params.GENOME} {RUN_DIR}/process/consolidated/{input} \
      {RUN_DIR}/process/aligned/{output} {params.BLATparams}
    """

rule compress_align:
  input:
    "{sample}.{type}.psl"
  output:
    "{sample}.{type}.psl.gz"
  shell:
    "gzip {RUN_DIR}/process/aligned/{input}"

