# -*- mode: Snakemake -*-
# Post-Alignment Processing: BLAT

rule all_uniq_sites:
  input:
    expand(RUN_DIR + "/process/processedData/uniqSites/{sample}.uniq.csv", sample=SAMPLES)
  output:
    RUN_DIR + "/process/processedData/unique_sites." + RUN + ".csv"
  shell:
    """
    PROC_DIR="{RUN_DIR}/process/processedData"
    head -n 1 -q ${{PROC_DIR}}/uniqSites/* | uniq > {output}
    cat ${{PROC_DIR}}/uniqSites/* | sed '/seqnames/d' >> {output}
    """

rule all_edit_sites:
  input:
    RUN_DIR + "process/processedData/unique_sites." + RUN + ".csv"
  output:
    RUN_DIR + "process/processedData/edited_sites." + RUN + ".rds"
  shell:
    """
    PROC_DIR="{RUN_DIR}/process/processedData"
    TOOL="{ROOT_DIR}/tools/postProcessing/postProcess.R"
    Rscript ${{TOOL}}
    """

