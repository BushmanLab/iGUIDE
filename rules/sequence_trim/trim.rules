# -*- mode: Snakemake -*-
# Look into turning the metadata into a dictionary
# Sequence Trimming Rules

rule seq_trim:
  input:
    "demultiplexed/{sample}.{read}.fastq.gz"
  output:
    "trimmed/{sample}.{read}.trim.fastq.gz"
  params:
    ROOT_DIR,
    RUN_DIR,
    R1leadTrim=sampleInfo["R1leadTrim"],
    R1overTrim=sampleInfo["R1overTrim"],
    R2leadTrim=sampleInfo["R2leadTrim"],
    R2overTrim=sampleInfo["R2overTrim"]
  shell:
    """
    TOOL="'{params:ROOT_DIR}'/tools/seqTrimR/seqTrim.R"
    READ=$(echo {sample} | cut -d '.' -f 2)
    if [ ${READ} = "R1"]
      Rscript ${TOOL} {input.sample} -o {output.trim} \
        -l {params.R1leadTrim} -r {params.R1overTrim} --compress
    else
      Rscript ${TOOL} {input.sample} -o {output.trim} \
        -l {params.R2leadTrim} -r {params.R2overTrim} --compress
    fi
    """

